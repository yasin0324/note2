# JavaScript的面向对象

---

JavaScript是支持多种编程范式的，包括函数式编程和面对对象编程

+ JavaScript中的对象被设计成一组**属性的无序集合**，像是一个哈希表，有key和value组成
+ **key是一个标识符名称，value可以是任意类型**，也可以是**其他对象或者函数类型**
+ 如果一个值**是一个函数**，那么我们可以称之为是**对象的方法**

> 如何创建一个对象？
>
> + 早期创建对象的方式最多的是使用Object类，并且使用new关键字来创建一个对象
>   + `var obj = new Object()`
>   + 这是因为早期很多JavaScript开发者是从Java过来的，他们更习惯于Java中通过new的方式创建一个对象
> + 后来很多开发者为了方便，直接通过字面量的形式来创建对象
>   + `var obj = { name: 'yasin' }`

# 对对象属性的操作

---

如果我们想要对**一个对象属性进行比较精准的操作控制**，我们可以使用**属性描述符**

+ 通过属性描述符**可以精准地添加或修改对象的属性**
+ 属性描述符需要使用`Object.defineProperty`来对属性进行添加或修改

## Object.defineProperty

`Object.defineProperty(obj, prop, descriptor)`

`Object.definProperty()`方法会直接在一个对象上定义一个新属性，或者修改一个对象的现有属性，并返回此对象

可接收三个参数：

+ `obj` 要定义属性的对象
+ `prop` 要定义或修改的属性的名称或`Symbol`
+ `descriptor` 要定义或修改的属性描述符

返回值：

+ 被传递给函数的对象

## 属性描述符

属性描述符的类型有两种：

+ **数据属性**（Data Properties）描述符（Descriptor）
+ **存取属性**（Accessor Properties）描述符（Descriptor）

|       | configurable | enumerable | value | writable | get | set |
| ----- | ------------ | ---------- | ----- | -------- | --- | --- |
| 数据描述符 | 可以           | 可以         | 可以    | 可以       | 不可以 | 不可以 |
| 存取描述符 | 可以           | 可以         | 不可以   | 不可以      | 可以  | 可以  |

## 数据属性描述符

+ `[[Configurable]]`（可配置的）：表示属性是否可以通过`delete`删除，是否可以修改它的特性，或者是否可以将它修改为存取属性描述符
  + 当我们直接在一个对象上定义某个属性时，这个属性的`[[Configurable]]`为`true`
  + 当我们通过属性描述符定义一个属性时，这个属性的`[[Configurable]]`默认为`false`
+ `[[Enumerable]]`（可枚举的）：表示属性是否可以通过`for-in`或者`Object.keys()`返回该属性
  + 当我们直接在一个对象上定义某个属性时，这个属性的`[[Enumerable]]`为`true`
  + 当我们通过属性描述符定义一个属性时，这个属性的`[[Enumerable]]`默认为`false`
+ `[[Writable]]`（可修改/写的）：表示是否可以修改属性的值
  + 当我们直接在一个对象上定义某个属性时，这个属性的`[[Writable]]`为`true`
  + 当我们通过属性描述符定义一个属性时，这个属性的`[[Writable]]`默认为`false`
+ `[[value]]`：属性的`value`值，读取属性时会返回该值，修改属性时，会对其进行修改
  + 默认情况下这个值是`undefined`

```js
Object.defineProperty(obj, "name", {
  configurable: false,
  enumerable: false,
  writable: false,
  value: "yasin"
})
```

## 存取属性描述符

+ `[[Configurable]]`：表示属性是否可以通过`delete`删除，是否可以修改它的特性，或者是否可以将它修改为存取属性描述符
  + 当我们直接在一个对象上定义某个属性时，这个属性的`[[Configurable]]`为`true`
  + 当我们通过属性描述符定义一个属性时，这个属性的`[[Configurable]]`为默认`false`
+ `[[Enumerable]]`：表示属性是否可以通过`for-in`或者`Object.keys()`返回该属性
  + 当我们直接在一个对象上定义某个属性时，这个属性的`[[Enumerable]]`为`true`
  + 当我们通过属性描述符定义一个属性时，这个属性的`[[Enumerable]]`默认为`false`
+ `[[get]]`：获取属性时会执行的函数。默认为`undefined`
+ `[[set]]`：设置属性时会执行的函数。默认为`undefined`

```js
var obj = {
  name: "yasin"
}

// 对obj对象中的name添加描述符（存取属性描述符）
var _name = ""
Object.defineProperty(obj, "name", {
  configurable: true,
  enumerable: false,
  set: function(value) {
    console.log("set", value);
    _name = value;
  },
  get: function() {
    console.log("get");
    return _name;
  }
})

obj.name = "Sakura";
obj.name = "qizui";
obj.name = "lll";

console.log(obj.name);
```

## 同时定义多个属性

`Object.defineProperties()`方法直接在一个对象上定义多个新的属性或修改现有属性，并且返回该对象

```js
var obj = {
  name: "yasin",
  age: 22,
  height: 1.82
}

// Object.defineProperty(obj, "name", {});
// Object.defineProperty(obj, "age", {});
// Object.defineProperty(obj, "height", {});

Object.defineProperties(obj, {
  name: {
    configurable: true,
    enumerable: true,
    writable: false
  },
  age: {
  },
  height:{
  }
})
```

## 对象方法补充（了解即可）

+ 获取对象的属性描述符
  + `getOwnPropertyDescriptor`
  + `getOwnPropertyDescriptors`
+ 禁止对象扩展新属性
  + `preventExtensions`
  + 给一个对象添加新的属性会失败（严格模式下会报错）
+ 密封对象，不允许配置和删除属性
  + `seal`
  + 实际是调用`preventExtensions`，并将现有属性的`configurable:false`
+ 冻结对象，不允许修改现有属性
  + `freeze`
  + 实际上是调用`seal`，并将现有属性的`writable:false`
